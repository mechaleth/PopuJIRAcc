# Мысли по схеме
- сервис Аналитика
	- под BI отдельный сервис:
		- обеспечит гибкость - можно первое время пользоваться готовыми решениями, а потом оставить как бэк-сервис, можно сразу бэк-сервис
		- менеджмент может захотеть видеть связи между разными величинами и строить смешанные абсурдные метрики - нужно помочь бизнесу, а делать это лучше в отдельном сервисе
			- [ ] сбор инфы по сервису по расписанию, ленивое, асинхронное по природе, но запросы пойдут на другие хранилища, так что синхронное по сути
				- [ ] пока не придумал события для запуска процесса
		- cтруктура:
			- отдельное хранилище
				- предполагается, что расчётные данные хранятся с горизонтом не более года - попуги не запомнят, а у топов 7 пятниц на неделе. Но уточняемо.
				- Резервное копирование раз в сутки - топы, как и попуги, вообще ничего могут не вспомнить. 
			- ETL-модули
			- локальная админка по токену
			- сам сервис:
				- либо разворачивается CI/CD. Гитхаб и конфиги.
				- либо храним конфиги BI и ядро.
		- связи в соответствии со схемой с:
			- сервисом тасков - подписан на топик, асинхронное, данные про:
				- таски по попугам;
			- сервисом аккаунтинга - подписан на топик, асинхронное, инфа про:
				- баланс попугов;
				- стоимость задач;
			- сервисом сотрудников - подписан на топик, асинхронное, инфа:
				- апдейты по попугам, их должностям и подразделениям;
			- фронт - как вариант, синхронное, получает токен, передаёт запрашиваемую информацию
			- сервис авторизации, синхронное - получить ключ для расшифровки токена
		- потребляет информацию со стандартной предобработкой сервисов
- фронт
	- отображение пользовательского интерфейса
	- общий на все сервисы - так как нужно соблюсти единую стилистику.
	- связь с клиентом. Условно делится на серверную часть и "клиентский фронт"
		- "клиентский фронт" общается со всеми сервисами, синхронно
			- общение с сервисом аналитики опционально - либо как бэк, либо перенаправление на BI, зависит от реализации и попуготопов)
			- передача токена и запроса, в ответ - запрашиваемая инфа, в соответствии с правами
		- серверная часть - только с сервисом админки, синхронно, для определения начальных параметров отправки данных
- [ ] Сервис тасков
	- хранит задачи и связь задач по сотрудникам;
	- есть локальная админка
	- БД - сотрудники (отдельно админы и манагеры), таски, привязки, сроки:
		- резервное копирование 2 раза в сутки - топы, как и попуги, вообще ничего могут не вспомнить. 
		- период хранения информации не более месяца - менеджемент и попуги всё равно не помнят, оно и к лучшему)
	- связи в соответствии со схемой с
		- сервисом сотрудников - подписан на топик, асинхронное, инфа:
			- апдейты по попугам, их должностям и подразделениям;
		- фронт, синхронное, получает токен, передаёт запрашиваемую информацию;
		- сервис авторизации, синхронное - получить ключ для расшифровки токена
- [ ] сервис сотрудников
	- хранит и апдейтит информацию о сотрудниках, их должностях, орг. структуре
	- есть локальная админка
	- БД
		- резервное копирование 2 раза в сутки - попуги могут забыть про работу и потеряться вообще. 
		- хранение информации не более года - надо же всё-таки убедиться, что попуг не сбежал, а потерялся!
	- связи в соответствии со схемой с
		- фронт, синхронное, получает токен, передаёт запрашиваемую информацию;
		- сервис авторизации, синхронное - получить ключ для расшифровки токена
- [ ] Сервис аккаунтинга
	- расчёты доходов/расходов по попугам по таскам. В конце дня деньги обнуляются
		- таск получен - списание; таск выполнен - начисление
		- отрицательный баланс сохраняется на следующий день, положительный выплачивается и обнуляется
	- есть локальная админка
	- БД - деньги по сотрудникам за день, сотрудники, деньги, начисления, списания, задачи (по деньгам, не по сотрудникам). 
		- резервное копирование - раз в сутки, после отправок сумм выплат и обнуления доходов.
		- хранение информации до года - закрытие финансовых периодов, хоть топы ничего и не помнят.
			- [ ] Требует уточнения, так как попуг может улетать в минус до бесконечности.
	- связи в соответствии со схемой с
		- почтовым сервером - синхронная, письма с суммой выплат по попугам;
		- фронтом, синхронное, получает токен, передаёт запрашиваемую информацию;
		- сервисом тасков - подписан на топик, асинхронное, данные про:
			- таски по попугам;
		- сервисом сотрудников - подписан на топик, асинхронное, инфа:
			- апдейты по попугам, их должностям и подразделениям;
-  сервис авторизации
	- общая админка, генерация токенов приватным ключом
	- БД - информация по попугам и их доступам:
		- резервное копирование - раз в сутки в соответствии с сервисом сотрудников;
		- хранение информации до года
	- связи:
		- с фронтом:
			- передача данных для отображения по части администрирования - синхронная;
			- передача данных для авторизации - синхронная;
			- передача токена - синхронная
		- сервисом сотрудников - подписан на топик, асинхронное, инфа:
			- апдейты по попугам, их должностям и подразделениям - тут для администрирования, группы по подразделениям могут иметь одинаковые права;
		- со всеми сервисами, кроме фронта
			- передача публичного ключа для расшифровки токена, синхронная
- почтовый сервер - внешний сервис
